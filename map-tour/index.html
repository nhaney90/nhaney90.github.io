<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Get started with SceneView - Create a 3D map - 4.0beta3</title>
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
    }
  </style>

  <link rel="stylesheet" href="https://js.arcgis.com/4.0beta3/esri/css/main.css">
  <script src="https://js.arcgis.com/4.0beta3/"></script>

  <script>
    require([
	"esri/Camera",
      "esri/Map",
	  "esri/geometry/Point",
      "esri/views/SceneView",
	  "esri/tasks/QueryTask",
	  "esri/tasks/support/Query",
	  "dojo/on",
      "dojo/domReady!"
    ], function(Camera, Map, Point, SceneView, QueryTask, Query, on) {
	  var routes = {
		MtMitchel:[],
		MtCheaha:[],
		GoldenIsles:[],
		Kyoto:[],
		Shirakawago:[]
	  }

      var map = new Map({
        basemap: "satellite"
      });

      var view = new SceneView({
        container: "viewDiv",
        map: map,
        scale: 50000000,
        center: [-101.17, 21, 78]
      });
	  
	  console.log(view);
	  
	  var qTask = new QueryTask({
		url: "https://services.arcgis.com/Wl7Y1m92PbjtJs5n/arcgis/rest/services/3DRoutes/FeatureServer/0"
	  });
	  
	  var params = new Query();
	  params.where = "1=1";
	  params.returnGeometry = true;
	  params.outFields = ["*"];
	  
	  qTask.execute(params).then(getResults, showError);
	  
	  function getResults(results) {
		/*for(var i = 0; i < results.features.length; i++) {
			var geometry = results.features[i].geometry.paths[0];
			var id = results.features[i].attributes.Id;
			switch(id) {
				case 1: routes.MtMitchel.push(geometry); break;
				case 2: routes.MtCheaha.push(geometry); break;
				case 3: routes.GoldenIsles.push(geometry); break;
				case 4: routes.Kyoto.push(geometry); break;
				case 5: routes.Shirakawago.push(geometry); break;
			}
		}*/
		//setTimeout(function() {
			animateRoute();
		//}, 2000);
	  }
	  
	  function showError(error) {
		console.log(error);
	  }
	  
	  function animateRoute() {
		/*point = new Point({
			x:routes.MtMitchel[0][0][0],
			y:routes.MtMitchel[0][0][1],
			z: 100,
			spatialReference: 4326
		});*/
		point = new Point({
			x: -9157260.098,
			y: 4268296.724,
			z: 2089.87,
			spatialReference: 102100
		});		
		var camera = new Camera({
			position: point,
			//tilt: 90,
			tilt: 77.240,
			heading: 278,
			fov: 100,
			//heading: 208
		});
		view.animateTo(camera);
	  }
	  
	  on(view, "click", function(){console.log(view);});
	  
	  window.onkeypress = function(evt) {
	    console.log(evt.keyCode);
		switch(evt.keyCode) {
			case 97: rotateLeft(); break;
			case 100: rotateRight(); break;
			case 119: tiltUp(); break;
			case 115: tiltDown(); break;
			case 113: moveHigher(); break;
			case 101: moveLower(); break;
		}
	  }
	  
	  function rotateLeft() {
	    var newHeading = view.camera.heading - 2;
		view.animateTo({
			heading: newHeading
		});
	  }
	  
	  function rotateRight() {
	    var newHeading = view.camera.heading + 2;
		view.animateTo({
			heading: newHeading
		});	  
	  }
	  
	  function tiltUp() {
	    var newTilt = view.camera.tilt - 2;
		view.animateTo({
			tilt: newTilt
		});		
	  }
	  
	  function tiltDown() {
	    var newTilt = view.camera.tilt + 2;
		view.animateTo({
			tilt: newTilt
		});	  
	  }
	  
	  function moveHigher() {
	    var point = view.camera.position;
		point.z += 100;
		view.animateTo({
			position: point
		});	  
	  }
	  
	  function moveLower() {
	    var point = view.camera.position;
		point.z -= 100;
		view.animateTo({
			position: point
		});
	  }
	  

    });
  </script>
</head>

<body>
  <div id="viewDiv"></div>
</body>
</html>